<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Statistically model trends in current, former and never smoking — trend_fit • smktrans</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Statistically model trends in current, former and never smoking — trend_fit"><meta property="og:description" content="Fit a multinomial model to the distribution of people 
among current, former and never smoking status
and estimate the variation in trends by sex and socioeconomic conditions in terms of
quintiles of the Index of Multiple Deprivation. The parameterisation of the 
statistical model within this function can have a strong effect on the estimated probabilities of 
quitting smoking and on the trajectories of smoking prevalence that are forecast using these estimates."><meta property="og:image" content="https://stapm.gitlab.io/r-packages/smktrans/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-167990045-1"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-167990045-1');
</script></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">smktrans</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.5.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../articles/smktrans.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Functions</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Technical documentation
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/smk_trans_prob_estimation.pdf">Estimation workflow</a>
    </li>
    <li>
      <a href="../articles/smoking_transition_probabilities_modelling_report.html">Methods notes: Smoking state transition probability estimation</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://gitlab.com/stapm/r-packages/smktrans" class="external-link">
    <span class="fab fa-gitlab fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="https://stapm.gitlab.io/software.html" class="external-link">
    <span class="fa fa-code"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Statistically model trends in current, former and never smoking</h1>
    
    <div class="hidden name"><code>trend_fit.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Fit a multinomial model to the distribution of people 
among current, former and never smoking status
and estimate the variation in trends by sex and socioeconomic conditions in terms of
quintiles of the Index of Multiple Deprivation. The parameterisation of the 
statistical model within this function can have a strong effect on the estimated probabilities of 
quitting smoking and on the trajectories of smoking prevalence that are forecast using these estimates.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">trend_fit</span><span class="op">(</span></span>
<span>  <span class="va">data</span>,</span>
<span>  max_iterations <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>  age_var <span class="op">=</span> <span class="st">"age"</span>,</span>
<span>  year_var <span class="op">=</span> <span class="st">"year"</span>,</span>
<span>  sex_var <span class="op">=</span> <span class="st">"sex"</span>,</span>
<span>  smoker_state_var <span class="op">=</span> <span class="st">"smk.state"</span>,</span>
<span>  imd_var <span class="op">=</span> <span class="st">"imd_quintile"</span>,</span>
<span>  weight_var <span class="op">=</span> <span class="st">"wt_int"</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>data</dt>
<dd><p>Data table containing individual-level survey data over multiple years.</p></dd>


<dt>max_iterations</dt>
<dd><p>Integer - the maximum number of iterations to try when looking for the
multinomial model to converge to a stable model fit.</p></dd>


<dt>age_var</dt>
<dd><p>Character - the name of the variable containing age in single years.</p></dd>


<dt>year_var</dt>
<dd><p>Character - the name of the variable containing year in single years.</p></dd>


<dt>sex_var</dt>
<dd><p>Character - the name of the variable containing sex (m/f).</p></dd>


<dt>smoker_state_var</dt>
<dd><p>Character - the name of the variable containing smoking status
(current, former, never smoker).</p></dd>


<dt>imd_var</dt>
<dd><p>Character - the name 
of the variable containing Index of Multiple Deprivation quintiles.</p></dd>


<dt>weight_var</dt>
<dd><p>Character - the name of the variable containing the survey weights.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>Returns a data table containing the fitted values by age, year, sex and IMD quintile.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>The explanatory variables for age and year are specified 
in the form of a cubic response surface.
An additional 4th order term for age is added to better capture 
the non-linear patterns over age e.g.
as individuals initiate and then quit with age. 
Interactions of this surface with sex and IMD quintiles
are limited to 3rd order terms. Interactions with the quadratic 
term are included for age but not for year
to avoid over-fitting variation in the trend over years, 
which is more of a linear change than the pattern over age.
The decision to do so was made after visually exploring the fit of 
simpler and more complex model specifications
to the data.</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">test_data</span> <span class="op">&lt;-</span> <span class="fu">trend_fit</span><span class="op">(</span>data <span class="op">=</span> <span class="va">hse_data</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by <a href="https://www.sheffield.ac.uk/scharr/sections/heds/staff/gillespie_d" class="external-link">Duncan Gillespie</a>, Laura Webster, <a href="https://www.sheffield.ac.uk/scharr/sections/heds/staff/brennan_a" class="external-link">Alan Brennan</a>.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

